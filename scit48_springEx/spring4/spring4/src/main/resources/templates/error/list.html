<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ë°©ëª…ë¡</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script th:inline="javascript">
        window.onload = function(){
            // ë©”ì‹œì§€ í† ìŠ¤íŠ¸
            const msg = [[${msg}]];
            if(msg){
                Swal.fire({
                    toast: true,
                    position: 'top',
                    icon: 'info',
                    title: msg,
                    showConfirmButton: false,
                    timer: 1500,
                    timerProgressBar: true
                });
            }

            // ì‚­ì œ ë²„íŠ¼ í™•ì¸ ëª¨ë‹¬
            document.querySelectorAll('form[action$="delete"]').forEach(form => {
                form.addEventListener('submit', function(e){
                    e.preventDefault();
                    Swal.fire({
                        title: 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                        text: 'ì‚­ì œí•˜ë©´ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#d33',
                        cancelButtonColor: '#3085d6',
                        confirmButtonText: 'ë„¤, ì‚­ì œí•©ë‹ˆë‹¤',
                        cancelButtonText: 'ì·¨ì†Œ'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            form.submit();
                        }
                    });
                });
            });

            // ì¶”ì²œ ë²„íŠ¼ í´ë¦­ ì‹œ í† ìŠ¤íŠ¸
            document.querySelectorAll('form[action$="recommend"]').forEach(form => {
                form.addEventListener('submit', function(e){
                    e.preventDefault();
                    Swal.fire({
                        toast: true,
                        position: 'top-end',
                        icon: 'success',
                        title: 'ì¶”ì²œ ì™„ë£Œ!',
                        showConfirmButton: false,
                        timer: 1200
                    });
                    setTimeout(() => form.submit(), 800);
                });
            });

            // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ ì•ˆë‚´
            document.querySelectorAll('form[action$="update"] button').forEach(btn => {
                btn.addEventListener('click', function(e){
                    e.preventDefault();
                    Swal.fire({
                        title: 'ìˆ˜ì • í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤',
                        icon: 'info',
                        timer: 1000,
                        showConfirmButton: false
                    }).then(() => {
                        btn.form.submit();
                    });
                });
            });

            // ì¹´ë“œ hover ì• ë‹ˆë©”ì´ì…˜
            document.querySelectorAll(".card").forEach(card => {
                card.addEventListener("mousemove", e => {
                    const r = card.getBoundingClientRect();
                    const x = ((e.clientX - r.left) / r.width - 0.5) * 10;
                    const y = ((e.clientY - r.top) / r.height - 0.5) * -10;
                    card.style.transform = `rotateX(${y}deg) rotateY(${x}deg)`;
                });
                card.addEventListener("mouseleave", () => {
                    card.style.transform = "";
                });
            });
        };
    </script>
    <style>
        body {
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  font-family: "Pretendard", "Inter", sans-serif;
  margin: 0;
  padding: 20px;
  color: #fff;
}

h1 {
  text-align: center;
  font-size: 2.2rem;
  background: linear-gradient(90deg, #00f2fe, #6a11cb);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 40px;
}

.guestbook {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
  gap: 24px;
}

.card {
  background: rgba(255,255,255,0.1);
  border-radius: 18px;
  backdrop-filter: blur(12px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  padding: 20px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover {
  transform: translateY(-8px) scale(1.03);
  box-shadow: 0 14px 32px rgba(0,0,0,0.35);
}

.card button, .card input[type="submit"] {
  background: linear-gradient(135deg, #00f2fe, #6a11cb);
  border: none;
  color: #fff;
  padding: 10px 16px;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.card button:hover, .card input[type="submit"]:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
}

.card textarea {
  width: 100%;
  border: none;
  resize: none;
  background: rgba(255,255,255,0.15);
  border-radius: 10px;
  padding: 12px;
  font-size: 14px;
  color: #fff;
}

    </style>
</head>
<body>
<h1>ë°©ëª…ë¡</h1>
<a th:href="@{/write}">ê¸€ì“°ê¸°</a>

<div class="guestbook" th:each="gb : ${guestbooklist}">
    <div class="card">
        <!-- ì¶”ì²œ ë²„íŠ¼ -->
        <form th:action="@{recommend}" method="post">
            <input type="hidden" name="num" th:value="${gb.num}">
            <button type="submit">
                ğŸ‘ğŸ‘ <span th:text="${gb.recommendCnt}">0</span>
            </button>
        </form>

        <p><strong>ë²ˆí˜¸:</strong> <span th:text="${gb.num}"></span></p>
        <p><strong>ì‘ì„±ì:</strong> <span th:text="${gb.name}"></span></p>
        <p><strong>ì‘ì„±ì¼:</strong> <span th:text="${#temporals.format(gb.inputdate, 'yy.MM.dd HH:mm:ss')}"></span></p>

        <textarea rows="4" cols="30" th:text="${gb.message}" readonly></textarea>

        <!-- ì‚­ì œ í¼ -->
        <form th:action="@{delete}" method="post">
            <input type="hidden" name="num" th:value="${gb.num}">
            <label>ë¹„ë°€ë²ˆí˜¸</label>
            <input type="text" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.." required>
            <input type="submit" value="ì‚­ì œ">
        </form>

        <!-- ìˆ˜ì • í¼ -->
        <form th:action="@{update}" method="get">
            <input type="hidden" name="num" th:value="${gb.num}">
            <button type="submit">ìˆ˜ì •</button>
        </form>
    </div>
</div>
</body>
</html>
